package com.revify.monolith.orders.service;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.reflect.TypeToken;
import com.revify.monolith.commons.auth.sync.UserUtils;
import com.revify.monolith.commons.messaging.KafkaTopic;
import com.revify.monolith.commons.messaging.dto.FanoutMessageBody;
import com.revify.monolith.commons.models.bid.AuctionCreationRequest;
import com.revify.monolith.commons.models.bid.PathFragment;
import com.revify.monolith.commons.models.orders.OrderCreationDTO;
import com.revify.monolith.commons.models.orders.OrderShipmentParticle;
import com.revify.monolith.commons.models.orders.OrderShipmentStatus;
import com.revify.monolith.commons.models.orders.OrderStatusUpdateRequest;
import com.revify.monolith.config.messaging.RabbitMqEndpointsConfiguration;
import com.revify.monolith.finance.messaging.DelayProducer;
import com.revify.monolith.finance.service.OrderPaymentService;
import com.revify.monolith.notifications.connector.producers.FanoutNotificationProducer;
import com.revify.monolith.orders.models.Delay;
import com.revify.monolith.orders.models.Order;
import com.revify.monolith.orders.models.PathSegment;
import io.vavr.Tuple2;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.apache.kafka.clients.producer.RecordMetadata;
import org.bson.types.ObjectId;
import org.springframework.amqp.core.Message;
import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.data.domain.Sort;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.core.query.Criteria;
import org.springframework.data.mongodb.core.query.Query;
import org.springframework.http.HttpStatus;
import org.springframework.kafka.core.KafkaTemplate;
import org.springframework.stereotype.Service;
import org.springframework.web.server.ResponseStatusException;

import java.time.Instant;
import java.time.temporal.ChronoUnit;
import java.util.List;
import java.util.Map;
import java.util.concurrent.atomic.AtomicReference;

import static com.revify.monolith.orders.models.utils.OrderUtils.findShipmentParticle;

@Slf4j
@Service
@RequiredArgsConstructor
public class OrderService {

    private final MongoTemplate mongoTemplate;

    private final KafkaTemplate<String, Object> kafkaTemplate;

    private final DelayProducer delayProducer;

    private final DelayService delayService;

    private final OrderPaymentService orderPaymentService;

    //todo remove and use direct, when normal integration utils arise
    private final FanoutNotificationProducer notificationProducer;

    private final Gson gson = new GsonBuilder().create();

    @RabbitListener(queues = RabbitMqEndpointsConfiguration.ORDER_SUMMARY)
    public void handleOrderFinalization(String messagePayload, Message message) {
        TypeToken<Map<String, String>> type = new TypeToken<>() {
        };
        Map<String, String> stringStringMap = gson.fromJson(messagePayload, type);
        if (stringStringMap != null && stringStringMap.containsKey("orderId")) {
            //check all payments for order
            //if some is missing - remove and start order
        }
    }

    public void activateOrder(String orderId) {
        Order orderById = findOrderById(new ObjectId(orderId));
        if (orderById == null) {
            return;
        }

        orderById.setStatus(OrderShipmentStatus.BOUGHT);
        orderById.setDeliveryTimeEnd(Instant.now().plus(7, ChronoUnit.DAYS).toEpochMilli());
        mongoTemplate.save(orderById);
    }

    public Order createOrder(OrderCreationDTO orderDto) {
        Order order = mongoTemplate.save(Order.from(orderDto));
        if (order.getId() == null) {
            throw new ResponseStatusException(HttpStatus.BAD_REQUEST, "Order creation failed");
        }
        {
            delayProducer.sendOrderSummarization(order.getId().toHexString(), orderDto.paymentsCutoff() == null ?
                    Instant.now().plus(3, ChronoUnit.DAYS).toEpochMilli() - Instant.now().toEpochMilli() : orderDto.paymentsCutoff());
        }

        saveShipmentParticles(order);
        orderPaymentService.processPayment(order);

        return order;
    }

    private void saveShipmentParticles(Order order) {
        var head = order.getShipmentParticle();
        while (head != null && head.getNext() != null) {
            PathSegment pathSegment = new PathSegment();
            pathSegment.setReceivers(order.getReceivers());
            pathSegment.setCourierId(head.getCourierId());
            pathSegment.setAcceptedCourierId(null);

            pathSegment.setOrder(order);
            pathSegment.setParticle(head);
            pathSegment.setValidUntil(Instant.now().plus(7, ChronoUnit.DAYS).toEpochMilli());

            pathSegment.setIsAcceptedByCustomer(true);
            pathSegment.setIsCompleted(false);
            pathSegment.setIsArchived(false);
            pathSegment.setIsShoplift(order.getIsShoplift());

            mongoTemplate.save(pathSegment);
            head = head.getNext();
        }
    }

    public List<Order> getUserOrders(Integer offset, Integer limit) {
        Criteria criteria = new Criteria().andOperator(
                Criteria.where("isSuspended").is(false),
                new Criteria().orOperator(
                        Criteria.where("receiverId").is(UserUtils.getUserId()),
                        Criteria.where("couriersInvolved").in(UserUtils.getUserId())
                )
        );

        return mongoTemplate.find(Query.query(criteria)
                .with(Sort.by(Sort.Direction.ASC, "deliveryTimeEnd"))
                .skip((long) offset * limit).limit(limit), Order.class);
    }

    //better create unified service for deps like write->read, to escape future circular and for the most part stay in cqrs
    public Order updateOrderStatus(OrderStatusUpdateRequest orderStatusUpdateRequest) {
        return updateOrderStatus(orderStatusUpdateRequest.orderId(), orderStatusUpdateRequest.newStatus());
    }

    public Order updateOrderStatus(String orderId, OrderShipmentStatus newStatus) {
        return updateOrderStatus(new ObjectId(orderId), newStatus);
    }

    public Order updateOrderStatus(ObjectId orderId, OrderShipmentStatus newStatus) {
        Order order = findOrderById(orderId);
        if (order == null) {
            throw new ResponseStatusException(HttpStatus.BAD_REQUEST, "Order not found");
        }
        Order save = mongoTemplate.save(applyStatusUpdate(order, newStatus));
        sendFanoutNotification(
                "Status Updated",
                "Order ID: " + save.getId().toHexString() + " updated to: " + save.getStatus()
        );

        return save;
    }

    /**
     * <img width="480" src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAABIAAAAKICAYAAAAIK4ENAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAGzMSURBVHhe7d0tjCVJnhjwk27BEUttdEssLRwdanYLy6wlkwEGJZm02QKDgsManKyBC0syGXhmJaOBAxc2HLiwYMOGbcX0vemoqMh8+TIjM+Pj95NCM9X1Kj8i4+tF/jPyH74AAAAA0LV/SP8BAAAAgL6YAAIAAADonAkgAAAAgM6ZAAIAAADonAkgAAAAgM6ZAAIAAADonAkgAAAAgM6ZAAIAAADonAkgAAAAgM6ZAAIAAADonAkgAAAAgM6ZAAIAAADonAkgAAAAgM6ZAAIAAADonAkgAAAAgM6ZAAIAAADonAkgAAAAgM6ZAAIAAADonAkgAAAAgM6ZAAIAAADonAkgAAAAgM6ZAAIAAADonAkgAAAAgM6ZAAIAAADonAkgAJrx008/ffnTn/705R/+4R92T2E/P/74Y3oIAADQJBNAADThw4cPryZpjkgfP35MDwUAAJpjAgiAaoSIm6MifNakcGyPj4/pYQMAQPVMAAFwul9//fXLn//851cTLrn07t27L58/f043UVSI+kn3G6cQjQQAAC0xAQTAoX7++efVUT739/e7T/5c/OUvf3m1/zSF8wjrEgEAQO1MAAFwqD/+8Y+vJlIu6Z/+6Z+qXXg5TDyF6KPcMQMAQO1MAAGwq6URP+ERsPAoWM3CJND79+9fHbu1gQAAqJ0JIAB2NRfx07IQ+ZOej7WBAACoVdujbwCqdS3yJ6yx07LwqFp6TiFZFwgAgBqZAAJgF7nInx7l1gayLhAAALXpczQOwOnSyZ/WI37m5NYGEgkEZXz69Om3xyvnIgpLJfUWgJ6ZAAJgVvwo1+XLUe7xrnQh5Ph3o8itC+QLJaz39PT05c2bN6/qVY0pbQMBoDbjjMoBWCV9lCtMcqSTP3G6LIQcT4aMYmpdII+EwTpp+9NCshg8ALUaZ1QOwE1yUT4hhUe5piY6Lin8/vKZnh/9mpLLH2C5XPuzdyRdrt6WTiICATiTESkAWbk771PShZBFvHwVR0GJCoDlbml/apC2gXNJ+wjAWeruTQE4XO7Oe0jXInnCF6D0b0a/2/3w8PAiP0wCwby17U8NcovBL02jt5UAHMMEEAAvbLnznlsEeeS73bmoAJNAMG1L+1O7XPuorQTgSP30qgAUkX4pueXO+9QaGiPf3c5NAoV8Al5L245b2p/aTbWPuRTaTO0EAKWZAALghfhLyBbp3e6R726nk0Aj5wXMKdX+tCRtK+P08ePH9OMAsNo4vSsAs3Jrb2wxd7d7xIigdI2kkAePj4/px2Bopdqflsy1laO2lwDsY5zeFYBZ6eRPqS9gU3e3R4yCyeXF8/Nz+jEYUlgfq3T706IQ9ZO2EyO2lwCUN27vCsAL6V3oUmtvpNsd+QteLi9EAcGX3+pBXC/u7+/TjwwltL9pWyESCICtxht9Awwo93hXjWmUhU/Dl7jLOd/d3aW/huHEb/8K62WFRybJRw2aCAJgLRNAAAPIvVq55tT7wqefPn168cXOq+EZXVz/Tf58k4saDMkjYQCsYQIIoFGtRPWUSr0tmpw+4jFC5BNMiesCr+UmgkQCAXArvSxAo9ZG9dQqt/BpLvUSLePV8PBNC21UDdJHwrQbANxCLwtQgaOieUot7LyXNCrmWmo9Kih9NTyMSj1YRiQQAFvoZQEqsDaa55J6l0bLpKnlqKCRriNMUQ9uIxIIgDX0svymZPSBO1GwXIm6V3tUTylhEuj9+/evzj9OLbY/rR8/bJFrA7lOJBAAa+hl+c3W6IM0uRMFy+TqHstMRQW11v64k8/ItIHbaD8AuIVedlDhDlF6x23v5M4UvJbWk9qjecLd+ru7u2rq8rWooBbandydfBhFWvZrbwNrk2s/am/zADiPUeaAwloZ6WCh1BeP9E5UmtyZgpdK1b2jXO7W11iXp9qfGo81p7WyACUo92XE7V8rbR4Ax9Pbdi73bP1c2nrnLXcnai61cHce9hTXhxbUfLxz7U8LbU3NeQt7Ue7LSNu/Fto8AI6nt+1c7tn6SwprZ4THJ44wdWc+JHeqGFlcF1rQ0vGm7U7tbU1LeQulKPfltNbmAXA8vW3HQvRPPBCI0/39/WGTP0F6Z2oquWPFKHLReS1o6Xhz7U7I88fHx/SjVYiP8/n5Of01dKmlNqV2uTZPWwJATG/bkWsLO9di7hhzyaQQPcpF57WgteMN0rvitbYt6Roe4csc9KrVSfAWaEsAmKK37cS1hZ23ru1TUu4O1bUkjJnepGW8pjo6Jz7mVsy1OTW1LQ8PD9UeG5TW6iR4C7QlAEzR2zYsd/csl1r4Yvn09PTl7du3r449l2q7aw9rxGW6Ja0edzD1yviahLaw1mODktJ62MJYpSVpW2LsBEBgdNmw3N2zIxd2PsLUoxvuZtG6uDy3pNXjTsVtS4igrEkveQxzlPP9pWMoYycA9LoNCnd1cpE/Ry/sfIS5RzfczaJlrX75afW4U+kjEjWtkdFLHsMc5Xx/uTEUAGPTEzQmvM0hvaMzUoeenru7WbSq1fob18GWhcnyEDFZY1vSatmAWyjnx5HXAFzoCRoxt97PSM/N5+5miQSiRa0OyC91sId2J0wC1diWtFo24BbK+XFqbOcAOIdetxG59X7Co2CjEglE63z5qUONbYmywQiU8+PU2M4BcA69bqXmIn5CCo8ujEwkEK3z5acOubbkbDUdC+24Nm64pFr6SuX8ODW2cwCcQw9QqVzEj077NXe1aJU6XZearkdNx0I75sYNaaqhr+xlPbGWaFsA0ANUKh2sXVIP626UlLurFRbKhtoZiNelpjZE2WCNtC+8lkIkUHgb3lnlvaf1xFqhbQFAD1CZXAg318V3EsP/1/RKZ8hRx+tSUxuibLBGXG4uKX3cK42anfss/dG2AKAHqEwuhJvrwl3MOM9qCG+HOep4XWpqQ+Iv6R8+fEh/DVlTkztxWc5FzU59lv7E1xqAMekBKpGL/AlJaPRy4a1ocd65k0nNDMTrk7YhZ0kno86MRqIdc5M7ueieUN7fvn276LP0oYb2DYBz6QEqIfKnjPQxDqiVul6nGq7L58+ff3vTo7aMLdKIoLlydMtnaVcN7RsA59IDnEzkT1npHVB3MqlVqwPx0Gbd3d11W69y12Wqne49hXN+fHx8kT+0I+0P4+ua1t/cZ2/1yy+/dN029GDL9QWgD3qAk4n8Kc+dTFrQap2/tFm91qvcdRlx8idO1iFqW9onhjRVf+PP3CpM/lz+9uPHj+mvqcCW6wtAH/QAJwp3ldNBmcif7UrcyeQcayMtcne0a9dq+Wz1uJfKnV+uTZHGTKGtaW1Npqnym2s349/f6v7+/ve//f7779NfU4Et1xeAPugBTpRG/1CWvG3PmsmfS5q6o12r+Nhb0upxL1XT+Z15LOk6RNLL1GqESxoNlLab8e9uFfJky9+zP9cHAD3ACXJRDiJ/yjPQac/UneqlKXdHu1bxcbek1eNeqqbzO/tYwiTQ+/fvX9Uz6dy0pZ3LtbGxqX9fauvfsy/XBwA9wAnSyB8d8T7kb7vmog/S9Uiu3dGuVavls9XjXqqm86vpWHgd4XJm2trOxdta8u9Lbf179uX6AKAHOFAu8ick0T/7uDbQSa/HlruqlLck+iBcs++++y7776Wu5V5vvbpWPmvV6nEvVdP51XQsfBX667S9aT3Fpv59qfjvS7bDlLH1+gLQPj3AgUT+HOtaPucm47beVWUfcxFBIYWooL0igfZ661V8rC1p9biXqun8ajoW6pC2cyXSRWhHc/9+i/T4SrebbLP1+gLQPj3AgdJBl8iffV0b6OTWQpj6LOe7FhGUfvEodS3j7T0/P6e/Xq30cR6l1eNeqqbzq+lYqMNUv7U2XcYhj4+PL/49vNFrjdzxUQ/XBQA9wIF0vMe6Jb/TAWuPKUQ8hUF+L3JRQekkUAnxNsP/l3oFdOnjPEqrx71UTecXH4vHadhD+ih0SKFdDe3rFjXVI75xXQDQAxxIx3usW/I7nTjoOaWLKLcsfEn5/vvvX53jJZXw8PDwarsl8rD0cR6l1eNeqqbzS9slj9NQWu7R9K2TP0Fcdku0l2xX4hE/ANqnBzhA7g4b+7slv3Nh61L7qZSnp6cvb9++fbHtrZFAexznEVo97qVqOr9cuwQl5MYlIZV6ND2dON/aXrJNqUf8AGif0eQBcnfY2J/8/ib3uNQIqaQ0D7dGY+x1nHuL7+z3qMbrUuMx0ba9xyWl20u2ia93iUf8AGhX2R6frHSQVeoOG/P2Gti26toiyj2m0kIeltp+qe0c7RKV0ms7VuN1qfGYaNPekT+xku0l28TXweQPwNj0yAcwADqHfB/T3te91PZLbYeyarwuNR4Tbdo78id11H6Y5zoAcKEnOICO9xzyfUx7X/d4+1vupMbbaekNTyGC4O7urpnjvdXe5WeNGo+JNsVlKaQ9In9iaTvX05soW6INAeBCT3AAHe855PuY9r7ub968+X3733333Ze//e1v6UcWafUNT5cIglaO91Z7l581ajwm2nT0Gl5pOxeSt4IdTxsCwIWe4AA63nPI97Hk1rbYw1//+tdXX2jWRMPk3vCUpnA+tb09Z+/8PVuN51fjMdGmo9fwmmrnamvXenVUvwhAO/QEB9DxnkO+j+XItS3ChE8cCRT2vVbuDnmaPn78mP7ZaY7I3zPVeH41HhPcwlvBznFkvwhAG/QEB9DxnkO+jyUd5O59h/v5+blIGZu6Qx6n77//Pv2z05Q455rVeH41HhPcylvBjpf2JXv3iwDUTw98AAOec8j3sZxxvffcZ4j62XP7a9V4TCXVeH41HhOsEZflGh9x7YVHvwCYokc4gA74HPJ9LEcvbhrE+9zjMa2wWGrYtgig49R4fjUeE6yRe+R1j7ZzdB79AmCKHuEAOuBjufM1pqMXNw3u7+9/L2M1TdLsqfd6VeP51XhMsEbukddR2s4jpXl8ZL8IQN2MJg9g8H4sd744SvqY1gh3snuvVzWeX43HBFukbadXw5elzQBgip7hADriY8X5HZI7X+wp3L2+lLW7u7vfFofuWe/tWY3nV+MxwVbv379/UbZNAm339PQkAhqAWXqGA+iIjyW/OVJ6JzuscfHw8NDtRFDv9avG86vxmGCr9NXwIZkEWi/0Obk1lgAgpmc4gI74WPKbo4Uos3TQHQbiP/30U/rR5vVav2peO6zGY4IScpNAIYW62GP7uYdc23VJIqABSBlNHsDg/TjhDpj85gwh9P7t27evBuC9rQvUa/2qee2wGo8JSpmaBAqT6FyXa7tCfwQAOUaTBzB431/uDlj4Mg5HCwPv77777vdy2Nsbbnptz9IvUDXdOe81z+EiTAKlawKFFPr1x8fH9ONMjHtCCpNpADDFaPIABu/7cweMmqTrAvUUBdRjexbWHan5vGo+Nigtt46NtYFey417AOAavcUBdM77SwdB7oBxtvjtYKE8fvr0Kf1Ik3prz0J0QXxO9/f36UdO11uew5wff/zxVZ9+SdYG+vLb+ecif2qKWgSgXkaTBzB43588pjZpFFC4W/vv//7v6cea01tdi++ih4m68ChKbXrLc1jC2kCvpdGK2gUAbqXXOIBOen/ymBrl3g52d3f35ddff00/2oye6lqIyorPp8bJn6CnPIdbTK0NFNJo0UBptOIlifwB4BZGkwcweN9PbhFEqEmI+smt1fDw8PDbW+ta00tdC1+m3rx508T5tHCMsLfc2kBx6nVCKPfIV63RigDUz2jyAAbv+8l9sYbahEiTH3744VVZDV9oWpsI6qGu5R6jqHndsB7yHLaaWxvoknp7PCzXVoVk8geAtYwmDxB32r3eoTpaLvInJKHQ1Cw8+hUeAUvLbfjSEr7ctCA+7paESbjwZSptN1pok1vNc9jLksmgXGqhvk+1VZdknAPAFkaTB0jDlnu7Q3UGkT+07Onp6cvbt2+bbBdaq3OXL1Pp414htfIYRWt5DkdLx1lzqda2toe2CoD6GU0eIHeninVyz8KH5I4YLQoTQXE5buFRsFbasbkvUyGF17238oWqlTyHs+TGWWvTEVFCU2OZXGqprQKgfkaTB4rvUIUvJtxm6ll4aFncLrSwJlDtdW9u4ueIL3Z7qD3PoQW1RAlNjWXi1GpbBUD9jCYPFL7Y5Tr5Vtb+OJPXn9KrXLuQthGh/NciPrZahLvjIZoqvC66p4mfi57OBc5SMkpor6R+A7C3ekbwAwhfUsJz3GmHH9LHjx/TjxOJ1/zxLDy9ya0JlKZaogbjYzpTWFD7r3/962SbGlIvX6bSyIU9oxNgZGld2zMZywBwhnNH8AMKnX24S50OBL7//vv0o0y87cuAiV4tmQi6pFAvwtoQYYLjyEfG4mM4WpgoDxFTaZuQpl4mfi5ykQtAebm6tkeyrg8AZzGKPFH4MhMPCGq5w18Tb/tiZHNRg2kKE0c//PDDl7/97W/pZoqK75AfYemkz3fffffb58Kkca/ivD9y0g8AgD4cM4JnUhoNFNa0MbD/Jv2SZ80fRjMVNTiXwjo4d3d3v00IhUiYX375Jd3sapc75HvXxRANNTfpE87xjAioM8WTgTWtCwUAQBtMAJ1s7g5/b48xLDX1elTgmxDpEyZ4lj4y1kMKEYFh4qnkhFZLQtt4yYswwQcAALfwrboCYRIorAGUftkJabTFPqdejxru9AN5IQImTA6EepJ7C1braeRJn1h4xX2cLwAAcAsjyIpcWwC294igqVe9WywRbhOig0J7EiZUw+Tyn//851f1qpW096NmrYnzBgAAbmEEWampV5H2HBHkVe8A80wAAQCwlhFkpa69ijREA/WyCKhXvUO+HuTSEZGANR0LL8X5DwAAtzCCbMRURFAPr473qnf4smjC5ZL2jgTM1cmptPex8FKc9wAAcAsjyEZciwi6pJbuyE9FGVjzgxEtreNTKa37U/Vrz5QeA+XF+Q0AALcwgmzQ3KvjQ2rljnwuygCYNhUJmKv7ufp1RGql/WlVnNcAAHALI8hGhUmg9+/fv/rylUu1rRc0FZkg8gfmbY0SKpnm3izGfuQzAABrGUF25Fp0QC3rBeUiE4D1rtX9KbmJ2LVKbIPr5DMAAGsZQXbk1uiAI9frmIr6CUnkD2yztu6nf7elLsbbYT/yGQCAtYwgO1fLekG5qB9fYKC8qbqWptJ1X70+hnwGAGAtI8gB3LJeUEh7rBmU7iOkLdEGQF5az66lUpGA8TbZj3wGAGAtI8hBXVszZM8E7OdaXbu17i+dILq2X8qQzwAArGUEOah07Y8jE7CP5+fnq3VtTd1f8rjYtf1SRjyBV8vC/gAAtMFInRdufVzs1uSxL9jPw8PD73Xt7du36a9fWTMZlEvpAu/sJ77GIYVrCAAASxipA3QiXgD66ekp/fXNbn1c7JLYT7qw/5LoLAAACIzUATpRehKmRITQHovKjy5MAsV5DAAASxg5AnTijEmBpVFC1qsp64xrDQBA24wcATpxxqTA//yf//PVZM+atPRtY3wV5x0AACxh5AjQiTMmBeJ1h9J9p+vVXEvWs1kul98AADDHyBGgE/GkwFHRNOkkTvqmvy1vFhQVNC3OJwAAWMLIEaAT8Xo8R0TThHV9SkxEzK0jdMR5tKhEvgMAMBYjR4BOpG/t2lN4s1e8r/v7+/Qji6XHHac0ooivjrrOAAD0w8gRoCPpBEqctj5S9fPPP/+2jXS7YZ2f8KgXxzEBBADArYwcAToy9zhVSFseqcot+BySyZ/jmQACAOBWRo4AHZl7nGqP5BGtc8TXAAAAljByBBjAtcigWxPnci0AALiVkSPAAEpGBon6OV98PQAAYAkjRwBoTBzR9eHDh/TXAADwigkgAGjMw8PDiyigEOEFAABzTAABQGPCm9fevXv3+wTQlre7AQAwBhNAANCgMAlkLSAAAJYyYgSARpkAAgBgKSNGAGiUCSAAAJYyYgSARpkAAgBgKSNGAIr69OnTb68m/9Of/vT75ET4/59++in9KBuZAAIAYCkjRgBWC5M68UTPXPKmqvJMAAEAsJQRIwCrhCifdJLnWqIseQsAwFJGjAAscku0T/zI19S/s50JIAAAljJiBOCquWifd+/effn8+XP6J78Lj37Fn/coWDkmgAAAWMqIEYCsJRE/9/f3s5M/wY8//vjq7yhDngIAsJQRIwCvTEX8XIv2mWOyojx5CgDAUkaMAPzm559/no34WRLtM8dkRXnyFACApYwYAfjNH//4x1eTPlsiflImK8qL11cKUVsAADDFKBxgcFNr/WyN+EnF2/Y2sDIeHh5e5GtYbwkAAHJMAAEMbGqtnz14G1h5YYIuRGnJUwAArtlnlA9A9R4fH19N/IR0d3eXfrQIbwPbR5gEkqcAAFxjpAgwkKnHveK0dxSJyYry5CkAANcYKQIMYupxr1za01H7GYk8BQDgGiNFgAFMPe41lfYU78di0GUcde0AAGiXkSLAAHKveE8nDdKf92Ix6PKOunYAALTLSBGgY09PT1fX/PnLX/7y22ePmkSwGHR58hIAgGuMFAE69fz8/CraZm6iYO53ezh6fz2TlwAAXGOkCNCph4eHV5M+l3SJ+okdPYlw9P56Ji8BALjGSBGgQ3PRP1OWfKako/fXM3kJAMA1RooAHbm25k8u8ufi6EmEo/fXM3kJAMA1RooAnZiL+lkyMXDLZ0s4en89k5cAAFxjpAjQiVvX/EkdPYkQ7y9ELf3000/pR1jo6GsHAEB7jBQBOvHHP/7x1cTPLRMCa/5mizRaKfzMOkdfOwAA2mOkCNCBT58+vZr4CWlJ5M/F0ZMIP/744+pj5aWjrx0AAO0xUgRo3OPj45c3b968mvy51Za/5VyuHQAA1xgpAjTsw4cPryZ+Qrq/v08/epVJhHa5dgAAXGOkCNCoEPmTTvxcJn8+f/6cfvwqkwjtcu0AALjGSBGgUblFn7cotR2O59oBAHCNkSJAY37++effXpueTv5sXUTZJEK7XDsAAK4xUgRoTOnIn4vS2+M4rh0AANcYKQI0YiryZ82CzzkmEdrl2gEAcI2RIkAjcpE/7969W7Xgc45JhHa5dgAAXGOkCNCIPSd/ApMI7XLtAAC4xkgRoAEfPnzYdfInMInQLtcOAIBrjBQBKvf4+Lj75E9gEqFdrh0AANcYKQJULl77Z6/Jn8AkQrtcOwAArjFSBKjcP/3TP/3+5X6vyZ/AJEK7XDsAAK4xUgSo3I8//vjbF/u//OUv6a+KMonQLtcOAIBrjBQB+I1JhHa5dgAAXGOkCDC4n3/++cuf/vQnkwgNc+0AALjGSBFgcPEi0yYR2uTaAQBwjZEiwODSyZ+91xqiPBNAQAk//fTTq4jQSwr/Hn4PQLuMFAEGZ/Kgfa4hsNWHDx9eTfqkKbyVEoB2GSkCDM7kQftcQ2Cp3LpvtybRQABtMlIEGFw8qKdNriGwVG7dtzi9e/fuy+fPn1/8TYj8ST8nGgigPUaKAIMzedA+1xBIrYn0ub+/fzX5E/z444+vPhuSSCCAthgpAgwuHszTJtcQSF2L9FnbXqTRQCKBANqxruUHoBtbvwxwPtcQiH369OnVZE+a1r7xMRcNJBIIoA1GigCDM3mwn/AIxt3d3e5fjFxDYO6Rrz2kkUAmggDqt0+PAEAz9v6SMLLLIxh7PyLhGgJTj3yFRZ33kIsEOqK9A2A9I0WAwZk82E+ct3veGXcNYUxzUT97tjmx3ERQ2Hf4dwDqYqQIMDiTB/tJH5HY6864awhjmor6OUPa3oX08ePH9GMAnOicHgKAapz9paFnU3fGS9+Vdw1hLHORP2sXd94q1959//336ccAOJGRIsDgTB7sL70zXjoSyDWEseQif2oRon5qPC4ATAABDM9AfX+5O+Ml18hwDaFvcxE/IZ0V9TMlbetKRz0CsI6RIsDgTB4cJ40ECqnEGhmuIfQtF/FTc51P27rSUY8ArFNnrwHAYWr/ItGTXCRQiTUyXEPoU2uRPxe5tk4kEMD5jBQBBmfy4Hil18gouS2gHrnIn5aIBAKoS1u9CADFtfrFonVxvj8/P6e/vsmSaxgiCe7u7tyBh4akkz+1RvxMyUUCAXAerTDA4AzMzxHfGQ//v2ZB6NzjIVMukQTuwEP9bqnbLejlPABapxUGGJyB+TkeHh5e5H1IHz58SD8265bHQ5Z8BqjDLXW7Bb2cB0DrtMIAgzMwP8/T09OXt2/fvrgGt0QCpV8Qc4+H9BZJAL0LdXZJ3W5JfC4Wg+ZWuX6sdFIuGYVRIMDg4gEQx/v8+fOXd+/e/X4NbnlEa8m16y2SAHqX1tkeWAyaLdI6sVdSLhlBH70KAKvFgx/OESaB4uuw9E7k3LWbumPaeiQB9CpXZ3uprxaDZou07JyVQv18fHxMDw+aovUFGFw8uOE8a+6Qz1273B1ToF4j1Nmez4397F1u0v73Wrp1vT6oyT61CIBm7D2wYpncHfJrkUBz1y7dVi+RBNCrEersLe0bXMz1dSXk+t9bkrJMS/apRQA0Ix7EcL70TuRcJNDctZv7HVCfEersLe0bXNRQN9L1+tKkLNOK82oRAFWoYWDFN7k7kVPSz+TWEJn7e+B8uXrbq1vaN7iopbyESaD379+/KsNpEhFEzc6tRQCcrpaBFS/Fd8qn1htIr11uDRHXFeqWq7e9G+lc2a7m8pJGtV2SiCBqVV8tAuBQNQ+sRvbw8PDi2uQmgeLfpxEEl9TjOiLQkxHrbHy+cE3N5SUX1XZJooCoUX21CIBD1TywGlluvYF0EigdbOYSULcR6+uI58w6od9rqbzEEUGigKhR/bUIgF21NLAazbVJoPjfc2mESAJo1Uhr/6RGPGdu9/j4+KKs3N/fpx+pThoRZD0gaqPVBRicgXjdcpNAYYAZxP+WJqBuI679cxGfsy/ITInrSOgHQ3/Ygty6QMo5tRinpwEga8QvH61JJ4EuYeXpANO1hHakdXakiL30C7JHZciJy0grkz9BGgWknFMTI0SAwcWDE+oVBr/ptUoHl+nvgXqNXF9zX5Ah1Xr5UM6pkVIIMDgDk3akr4aPr136M1A39VUeMK+X8tHLedAHpRBgcAYm7UhfDT+VWlgoE0an7ZUHzOulfMTnEdYCCotbw1nark0AbNbLAGsE6VpAudTSQpkwMm2vPGBeL+UjXfMqpPiNnnCktmsTAJv1MsAaRZjcef/+/avB5CWZ/IE2aHvlAfN6KR+5tYBCurzRE47Udm0CYLNeBlgjSgeTriG0Q72VB8zrrXykUbzeCsYZ+qhNAKzW2wBrJPG1cw3hPD///PNva3uk9XFtCtsaITogPeeffvop/QgDi8tHL9I3eir3HK2f2gTAKj0OsEaRW1cAOF7JyZ84ffz4Md1VV9I2TEQEsbhs9ES550x91SYAbtbrAGsE6boCf/nLX9KPAAdI62LJ1HOEQC7f4KLXcqHccyalDWBwBiAAx5tqe0PUT/rlsPcIgam8YGy9l4vez486KW0AgzMAATjeXNsbovni3/ce3TeXF4yr93IRPwrmtfAcpc/aBMBivQ+wAFKlF23eI/X86FcqPm+46L1cPDw8vDjHERZ+53x91iYAFut9gAWQ+uMf//hqwqXG1PujXxfxOcNF7+XCa+E5Q5+1CYDFeh9gAWOIo3ou0TMtRPpcS+H4Hx8f09PtSny+o0Q9cV1cLnqVvhYe9qaUAQzOwAPoQRrVE+6mp/+WSzVKXxMdUs9rhMTnKwqCi9rraSmjnCd1UMoABmfgAbRsKsrnP/2n//Tq39JU6+LKuddEp+laZFAuIqpW6flCMEqZGOU8qYNSBjA4Aw+gZbkon9y/tShdIySXpiKD0kmx2iNrWr9WlDdKmRjlPKmDUgYwOAMPoGVxGxbSf/tv/+3Vv9Ua6bNEmAR6//79q3NKUxrlk0bVXD4zFzV0pvg4IRilTIxyntRBKQMYnIEH0LJ4/Zggjf7p0VRkUC7Kp5X1hHq/ZtxulDIxynlSB6UMYHAGHkDLLpEulyifuE1rOfLnmrnIoDgaKBcJlH6mBvGxQTBKmRjlPKmDUgYwOAMPoCcjtmm5KJ80GigXNZR+5kwjXjfmjVImRjlP6qCUAQzOwAPoyYht2tIon1zUUC1qPCbONUqZGOU8qYNSBjA4Aw+gJ6O3ablooHQiaO53Zxn9uvHNzz///OXu7m6YMjHKeVIHpQxgcAYeQE9Gb9OmooHix73SSaIaHgUb/brxTbqQe+9lYpTzpA5KGcDgDDyAnmjTvspNBE39robFsnPHyZjSctt7mRjlPKmDUgYwOAMPoCfatJdayY9WjpP9xWVhhDIxynlSB6UMYHAGHkBPtGkvxflRy3o/Oa4bF3FZ6LlMhLWOQp3s/Typi1IGMDgDD6An2rSXalzvJ8d14yIuCz2XidHWOqIOShnA4Aw8gJ5o015K1/upNV9qPz6Ok5bXXstEeo41rMVF//qsTQAs1vsACxiLNi2v9nyp/fg4Tjox0muZ6P38qJPSBjA4AxCgJ9q0vNrzJT6+mtcqYn9xWai5zG7V+/lRJ6UNYHAGIEBPtGl5tedLK2sVsb+4HNRcZrfq/fyok9IGMDgDEKAn2rS82vOllbWKbpV701MuiXr6Js2bXsrCRa5MwFGUNoDBGYAAPdGm5cX5UvNkQ2/XL/2ivzaF7YRJshGk5x5ST7z9izMpbQCDMwABeqJNy2vlEaverl8usmlL+vjxY7qL7qTn3NvbsXo/P+rWR8sKwGrxIASgddq0vNxERI1qP76tPn/+/OX9+/evrkXpFCKGHh8f0903IT6PHvV+ftRNqQMYnIEI0BNt2rza86f24ztSGrW1Jn348CHdbPXi4+9NuB49nx/1U+oABmcgAvREmzav9vyp/fiOlIva2ppaiAxKj7fW9apuFfI9Prf7+/v0I7A7LSvA4OLBCEDrtGnzas+f2o+vBeExs3fv3r3IyzTVHBmURj7Vul7VreLFn8P1CdcJjqZlBRicwTbQE23avNrzp/bja8WStYZqfatYLvKpZbnXvpv84Sxt1yYANutlgAUQaNPm1Z4/tR9fy9LXj9ceWdNLWUjzvfXzoW1KH8DgDEiAnmjT5sX5U+PaKq5febkIlJDCY0g1i4+15bWA0nz32nfOpGUFGJzBNtATbdq8eH2VGiNAXL/yWo1A6WUtoNbynb4phQCDMzCpy9Sd2lpSy3dh6UuoK3d3d6/KY1xeeS1dXyU2ladHmjq2GpRsn49sS9N9txKBkpbVo/Ntq1x5gbMphQCDMzCpS+5ObW2p1buw9OVSV9LyGJdV8qbyaCpPjzR1bDUo3T4flc/xPlvUaiRQrrzA2ZRCgMEZmJzv06dPv72SN71TWGtq5e4xfYvL5JJ/55upPIr//axIi6ljWyIXcVFzOqItDf1LvM8W5SKBWpAe8xHXG65po/YAsJvWBlQ9WPol5UiXYzrrSx/caqquTP0730zlUQ2RFlPHtsSSdrVUasHT09OXN2/eNHfcU+LzqLmvyvXxUAulEWBwBijHy4WFp+noO4XxYPWML31wq3iyIqZNu24qj2qItNiy79zx75GObp/XSvua2t/6dU0NE5RLpPkeEtRCaQQYnAHK/sJdyvRuYJrOvps59cXp7OOCKZcym34Z16Zddy2Prv1+T2fuuxe5CJQe2vFcP1Wj9BjTNgrOVGetAeAwtQ+kWhfW9kkHg7XmeXp39ZJqvcsKObXWr5pcy6Nrv9/TmfvuRe8RKHFfFfrYmjw/P3eb7/RBqQQYnIFKebm7r7lU213B3N3VSxIJVKelZe1yDcM17l18zuRdy6Nrv9/Tmftu2VxbUFtfs9XDw8Orc6ylfYuP7e3bt+mv4XRaVoDBGWyXl7v7GtZe+Pz5c/rRqqURQSKB6jP1hW8uffz4Md1MV+JzJe9aHl37/Z7O3HfLcv1Or3kY+tLQp6bnGtLZ7Vt8HcIi3FCbPlsFABbrfaB4pKk7sPf3981N/gS5iKBwfo+Pj+lHOUnuGq1JPUV4xedF3rU8uvb7PZ257xZN9Tsh9Rb5Ewt96vv371+d8/fff59+9BC56wA1UjIBBmewUk7uDmwP0kigkGpbd4Gvctdqaeolwis+J/Ku5dG13+/pzH23KJ10GDHfQtTP2effa/9Pf5RMgMEZrJSTDv56ufs6FWXSU9RIL6au1dLUwzWNz4e8a3l07fd7OnPfLUrrfC/9zq3iPLikI9qzXOTPyNeB+mlZAQZnsF1O73mZW3ehl6iRXuWu2bXU+jWNz4W8a3l07fd7OnPftGsq+nHv9kzkD61RQgEGZ9BSRrgLOEJe5tZdoG65a3YtHXHnfC/K5nXX8uja7/d05r45Xug77+7uNrc3aSRUnPZqzz59+vRqXyJ/qJ2WFWBwBtvbTIV/9+6IwTXHmLpznqZWFgAfqR6udS2Prv1+T2fum/1N9ZmlI3WutWtb+63QFr5580Z5pTlKKsDgDF62yYV/j3AHMB1clx68c5y5O+e5VPsC4PGxknctj+L6fbRrx0bbcn3mHtd7Sbu2tt8KbWC6rfCoLbSgbE0DoDl7Db5GkQ4CR5j8CXKDa/qQu7a5tPUO+lZTj44ok/OWPK56KQNntGfXjo02TUX+7H29l7Zna9PZ7SDcap+aBkAz4oEMtxs9/0Y//1FMLSa99g56CZdIgvQYlMl5aQRGbWo+NtZLy93l+qY/HyGNYF2bQpsY2kZoyXE1DYAqxYMZbjd6/o1+/iOZWkz6LFPHEP+7O/OvxflzRoTPNVPXlXalUWch/Zf/8l++/OEPfzjlepeICrq/vzf5Q5OOq2kAVCke0HC70fNv9PMfVQ3XfeoY4rv7aXQQ0/lWi9qPj9ul0T/BP/7jP774N9cbjqGmAQzO4Gub0fOvt/Nfsk7FEan2N27Fx3qWqWNI7+7zUu15U/vxcbv4ml6izuJ/uyTr6cD+tKwAgzPY3mb0/Ovt/GuY/IlTjW/cSt+Ac5a5Y5j73ehqz5vaj4/b5d4qF1/nOInag31pWQEGZ7C9zej519v5p9EjPaSSd9XTyZ+wDsZZ4uNIzf1uVLnothrVfnzcLvdWufg6pwnYjxoGMDiDrm1Gz7/Rz38PU2/c2pJK3FVPJ3/OfgNOLqrgIj5OvkrXYak1b2o/PspIr3P6M7APNQxgcAZd24yef6Of/16m3ri1Nq1921MuaiSksyd/glxUwUV8rD0I1+Hu7m5TJFd6DXP5VoPerh0v5dqUIP0Z2IcaBjA4g65tRs+/0c+/d7mokRomf67prVxersOWSK5W8qSV42SdXJsSpD8D+1DDAAZn0LXN6Pk3+vn3Lv2iFtb8qX3yJ+ilXE5FS6xRYhtHaOU4WSdtU3JvBQP2o4YBDM6ga5vR82/08+/V09NTsYmHM7R63Be5iZ+t51NiG0do5ThZZ+r6Tv07UJYaBjA4g65tRs+/0c+/R8/Pzy8WWG7x+sbHHxavbk3uMZmt16HENo7QynGyztT1nfp3oCw1DGBwBl3bjJ5/o59/j8IjGfF1DanWBYOnPDw8vDj+sGB0K8JCz2n+b7kOuWiimrVynNzmWlTh1L8DZalhAIMz6Npm9Pwb/fx7k77qPXxpa1FYpygsVn05jy2LJx8pzf8S9SsXTVSzVo6T5ZZEFU79O1CWGgYwOIOubUbPv9HPvwe5CJGQwgRKy8IkUAvlcyr/4xQW377V1HbXRBEdqYVrxjJTZTBXDl13OIYaBjA4g65tRs+/0c+/B7kIkRZe9b5EC+Uzl/8lrkVuuy1o7XiZliuDU1GFrjscQw0DGJxB1zaj59/o59+yqbvzrbzqfYmay+dU/m+9FlPbTSMualXzNWOZsI5VrgzORRW67nAMNQxgcAZd24yef6Off8tyd+d7U/O55fL/ktZG/QS57bak1ePmq6l1rK655bPAemoYwOAMurYZPf9GP/8WtR4hcov4/MI5h8iEs03l/yWtifoJprY7d13jv6klf+Jjpy2Pj4+vyt+1MnjhusMx1DCAwRl0bTN6/o1+/i1qPULkFumbh2p4G1gu/0tch9x2r0n/pob8ueX4qUtcnm6NYovrKrAfNQxgcAbb24yef6Off0vWRIi07scff3x1vmdLj2fLdZi6pku3t+Zv9hYfD23IlcNbJn+CS12toQxCz7SsAIMz2N5m9Pwb/fxbkkZ7jHTN4nM+61Gn3Jfk3HWY+9zSdE1uH7Wo8ZjIy5Uj1w7qpnYCDM6AbZvR82/0829JjY9DHaWGc89NwOXqztznlqQlERS5fdSixmMiL1eOlpZB4BxaVoDBGWxvM3r+jX7+LUkfhxrpS1p67keX1xApke6/ZLrlWuaO5Za/31t8XNRpKvKnpnIE5GlZAQZnsL3NyPmXvu4XandWeZ2KlLiW9pAeS21qPja+SsuQawXtUFsBBmcAt82o+Ze+7je8uhpqlYtYOGItoNx+90rXzid3LDVGbMTHR31qjyAD5mlZAQZnsL3NqPm35XW/cLR04uOS9l4LaGq/e6W582klaqP24xtdWo6Atqi1AIMzkNsmzr9rd+B7kd4BNvlD7XJrAJVKc/V+z/3m0lwkxi2fPVN8jNQjlPF0QrPWMgRM07ICDM5ge5sa3i50NHeAaVVaX0ulFup9fO41i48zrDPG+dL13looR0CemgswOIO5bXJ3+KeiAVrXyhoiMCVXX2tNc5FFa1zOvfY6+/Dw8CIfwnFznqnJn9rLEZBntA8wuHhAx3rxXesWogHWSCN/lBlaVSoaZq+IokvqtS2ZEx4pDeuKjZwHtUgnf6z3Bu3b1usB0Lx4cMd6aWRB6bv3NUi/nLoDTKu2RMPkIuGOSD22KVPCJEN87hwvfdOjyR/ogxYVYHAG2eWk0QC93blWVmD/N3uFdiNtS+LfjSI+b47nTY/QJy0qwOAMsstJo4B6ydNcxAOMKlfPS6YQlTS3j1GMeM61+PTp04v8N/kD/dCiAgzOILu8OE/DxEkIpW9RbuLnknK/a/lcoWZpPRvhUbD4nDlOaMPfvHkj/6FTajTA4Azyyss9vtHi64xziz6H9I//+I+Tv2v1XKFmaZsywqNg8flyjHTR55DC419AP7SoAIMzyC5v6vGNViZGctE9W9IoEQuwl7RNWbN4dWvi82V/6aLP2m3okxYVYHAG2ftJX2ccUguTQHPRPbkU5M41TiNELADlpG0M+7LoM4xBiwowOIPsfU1NjNR4d3Uq8udf//VfX/3b2lTjeUMpoQ7d3d0p4wXE7Qb7mGrzTf5Av7SoAIMzyN7f1CRQbVExucifWHrs6WeXptrOG0q51CFlfLu4zWAfuTZffkPf1HCAwRn0HSNMAr1///7VQDukM6Nipu4Ah3RZZyT3mf/8n//zq88vTSOsX8KY4nLONvJyP7k2XfsMY9CiAgzOIPt4ueiZsyIGltwBnvrMWccMtZqqQ9xOXu4n16YDY1DbgaZZb2E7A8DjpW/0mUrhDm14M0tJc3d+Lym9A5z+Pk7qHnwT1w22kZflTbX/aZsP9EuLCjTNegvbGWSfKxcNlKaSbw7L3fm9dv3Tz8THrO7BN2ldYT15WV6u/QfGotYDTTOI2U4enmtpNNDeae4OcPy5ID1m4Cv1ohx5Wd4t7T7QJy0q0DQDxO3kYZ2m3hxWMi2V+5v4385cxBpqkqsrrCMvy8k9+gWMSe0HmmYws508rNfcm8O2plvu/MZ/d5E+uuZRMMjXFdaRl+V49Au4UPuBphnMbCcPuSZXRtLHwJQfyNcV1pGX2+Uif0K65QYA0BctKtA0A8Tt5CHXzJWROBKo5GLV0KK5usJt5OV2In+AlFaAJnjVN1MMaraTh0zJ3T1OPTw8vPqCYU0gRjVXV9YYefxTOi9Hkmu7QxL5A2hRaYJXfTPFAHE7eciUJXePpxar1l4zorm6ssbI45/SeTmSJW03MCatAU3QgTFF2dhOHjIl/QIxdfd4arFqkUCMpnR7Wnp7LRn53LcI0T9pWzzVdgPj0aLSBIMApigb28lDpqwpG94OxsjW1Jk5pbfXkpHPfYs0+gcgplWgCToypigb28lDpqwpG7m3g4kEYhRr6kxObg2X0epRqbwcRa7MiPwBUlpUmmAQwBRlYzt5yJQ4mudWIoEYUan2NI3iGLEelcrLUeTKDEBKy0ATdGZMUTa2k4dMuUTzrLmLnIsECmm0KAbGkIu+2CKtN6W225IRz3mLtJysabeB/mlRaYJBAFOUje3kIXtKI4FCGimKgTGUjL54fn5+ta0S223NiOe81ocPH+QXsIgWgibo1JiibGwnD9nTVCQQ9CQt31uiLx4eHl5tL06jRNFpL5Z5fHx8kVf39/fpRwB+p0WlaqVDqumPsrGdPOQocVm7pFG+zNK3Eu1obswzlUaIoiuRpz3LlZd37959+fz5c/pRgN9pUalayZBq+qRsbCcPOUrucbCQRvgyS99KtKO5Mc9c6t1I57pGrryY/AGu0aJStbRj2xJSTZ8MELeThxxl6nGwkEQC0bIS7WhaJ9KUfqb3OpOeO1/lIn9CMkYGltCiUjWdP9coI9vJQ86SRgSJBKJVJdrReBu5FIxUZ9Jz56tc5A/AUloMbpbeedjzDpTOjWuUke3kIWe5FhEUfg8tKNGOpnUgLOabbjdXZ/Ych50pPffRpePvSxL5A9xCi8rNcnce9roDpfPnGmVkO3nI2dKohjh9/Pgx/ThUp0Q7Gm/jspjv1HbTOrPXOOxMU+c+qtz4G+BWWg5ulnY+U6nEHSmdHNcoI9vJQ86Wi2oo3Z/Ankq0o/E2Lov5Tm03V2d6qydT5z6SqaifkET+AGuM26KyWtz5pHeg0rT1jlS8LchRRraTh9QmRP2U7k9gTyXa0dw2cv8WS8dhPdWTa+c+glzUz8j5AWynBeFmaSd0LW1Rajv0SxnZTh5So3B3O+1PLincEX98fEz/BE5Toh3NbSP3b7FcJFAvUUDXzr1nIn+AvYzXorJZercpTpc7T6U67VLboV/KyDZppAXUZq7P+fDhQ/pxOEWJdjS3jdy/5cT1pJcooKXn3qNc5A9ACVoTbpa725R2UOnPa5XaDv1SRtYLa0y8ffv29/y7u7tLPwKnu9bnhLvhz8/P6Z/BoUr0Rblt5P4tJ60nPawHtPTcezIV+SPqByhlnBa1Y1OdRS1pi1LboV/KyHoheuKSd+GO8a+//pp+hI6FL4e5vqP2L45h4jK8ISk97suxe3U8ZyjRF8VRPBe3bDcXLVd7fZ5zy7m3bqo9HuHcgWNpVTqQCxOtKW1Rajv0SxlZL247fGkeSzz5l0u1P0ISJoG+//77V8d9SV4dz9Hi8rfWJYonjva4ZbtpFNAl1V6fp9xy7i2ba49F/gCl9d2iZtQeLdNj2qLUduiXMrKevBtTWDw5bafnUs0RBE9PTy8eY0yP20LR7C03rixpzXZzE0Etav34l5ia/DHxA+yl3xZ1QtpJ95ZqUeqYSm2Hfikj68m7McWRX+FRqhBNc5F7hCSkFiII0gXNL8lC0ewpF4Vd0pbt5h4pa8mWc29BOvmTtscAe+izRZ2RuyvSS6rpbkF8XFuU2g79UkbWk3djyUUqpF825vrIFsy9Ov6Sao5ooj1p+So9FttSB3OPlLVky7nXLLfej8kf4Ch9tahUo1SnXWo79EsZWU/ejWVNpMItn63J3ELRIbUQ0UQb9q4je2+/Zj2eexr1E5LJH+BI/bSoVCF3h3mLUtuhX8rIevJuLOmXjrmogNJt+RnCF6r379+/Ou9csl4Qa+1dR/befs16O/fc5M/9/b3JH+BQfbSoVGPNHeY5rT+/zv5KlbURybux3HK9S7fltZha4+iSrBfErfauI3tvv2Y9nXs6+SPqBzhL+y0qVUkH03N3mK8JHeNlO8L1mdLTAPFo8m4Mt0Tz5D67tS2vydwaR3ESEcRSS+rVFntvv2atn/tUe2ryBzhTmy0q1SrZWcdvdAmv+YWckmVuNPJuDLdE89zy2V7MrRckIohr9q4re2+/Zq2fe649NfkDnK3NFpXq5O5ybPX09PT7tr7//vv01/CbkmVuNPJuDOkXkLlonls+25Ol6wWFfi5EEcFFXD72sPf2a9bquefGxCFZ7weoQVstKtXK3eXYKg7V/+GHH9Jfw29KlrnRyLsx3HKdb/lsr+Yigi4pRKhCsHed2Xv7NWv13PcYEwOUokWiiLSjK3HXOGzjsj1rMTDFAGs9eTeGJdf506dPrxYp7Ul8Rz7896effko/8sKSiKCwnYeHhy/Pz8/pnzOQvevM3tuvWYvnHtrStK0oMSYGKKWdFpXqTIW4lnJ3d/f7Nn/55Zf01/CbPcreKOTdGK5d5zDB/ubNm93a8jNM9U+X9Ic//CH9k6videnm0pIJJvoRX/s97L39mrV27mHpgrQtBaiNlonVpgbXpcQhtO6wMmWPsjcKeTeGueucRv1cUut3rHOPYKRpjTgydS55c+U4tpapa/befs1aO/e03QmPkgLUpo0WlSrlXqdb6kvD3//+99+3Ge6mwJTWBog1kXd1uBatEqc10SXp36fb3LLtWDiPELm5ZRtr3JJ/pfqoINztD2+oTPcxl7bmMfWJr+8e9t5+zVo496n2Rz0HalVvi8rQQsd56US9AYw5LQwQayXv6pDeNb6Wbo0uSf8+l0q8mvhyHrce31bX8u9I4dzT/afp6PxhX3uXtb23X7MWzn2q/QGolRaKKsWLb/71r39Nfw2/M+BaT97tL3d3OI0CSb84LElL7i7n9p1LpV5NHG9zT0vPK6SSET9L5CJj51I4Dy85aFOuHO5h7+3XrOZzz13/Szq63QG4RX0tKiR3VLxulzk1DxBrJ+/2N3V3OI4CWXod4uiSJVEkU19Oru1nrb23fzGVp3vvd6u56KCwFhNtyZXDPey9/ZrVfO5HXX+A0rRWVCd+04r1f7jG4Gs9ebf/ujXpF4Q4XSKBll6HNLrkmvTzl1T67nTuTnhJue3nUunzKm3qekylNFKMuqTXa6/yF+9jNDWe+1R7tNf1ByitnhYV/kN45OvSoVr/h2tqHCC2Qt7tv25NmsdpFEj68zXx55dGjdyy/TX2vhOe2/4e+zlaeOwurL2UnlOc9iqXbHdUOTxqPzWq8dxz7RFAS7RaVCdM+lw6Vev/cI1B2Hoj513uLu6tlkQPpdu/FgVyzcPDw4vPh+1dk+4jpBLRJbk8DKnUnfCp7Zfez5nCJFC85t1csl5QXeJrs6ej9lOjms59qj3qoR0CxnJ+iwqJ8NjXpWO1/g/X1DRAbM3IeVfiLu6S6KGp7aeRP7nP5KRRI3P7vpja15K/nVMiD+fsvf2aTV2zkJZGfrGvo8rlUfupUU3nPnJ7BPRF60V1dK7cQnlZb6S8+/Tp029fnHN3cENacxc3/vupiJqpPJ6KBFoiTAIt2ffF1L6W/G1q6i54SGvycErYz57br93cNYtTuBYhKuz5+TndBDuLr8OejtpPjWo599B/pHVvpPYI6Mu5LSpk1NLh0wblZb1e825ukiKX1kqjNHIRNXP7SY8jpKUTMkv2PSX92xKplKlrN7o08msqmRA6zlHl86j91Oiscw9tcK4dOuNYAErTilEdnSy3UF7W6zXvcqH6U2nLXdxclEZq7ndTEzFLJnOW7HtK7m+3pC15mMpdu5Lbb9kt6wWFMmQiaF9xfu/pqP3U6IxzD5GiaX2KU5iIBWjZcS0qLHRGh0+7lJf1esm7qaiRNC2NrrnV3H7m8nhuImapNX9zMbf/a6n0pMzUNSy9n948PT19efv27at8W5JCfltUer04L/d01H5qtPe5T7U7ubRX/wFwtH1aVNhg7w6fvigv6/WSd7mokTXn9X//7//98r//9/9O//mqXCTPJYpnybHk/n6p+G9blruG3G7NhJBFpdc5qqwetZ8a7X3uuXbnkkKkT4i6A+jNPi0qbLB3h896c3fLzro7prys12LezZXBNN0aPRImf9bkxdJIminp399y3Je/veVvajJ1PVs9n1qsmQiaS2e17zWL82dPR+2nRmvOfapNuSXd39+b/AG6tbxFhYPEnTB1uTaoWrJ2SWnKy3ot5t3cHdsaziMXzVPLsdUodz3Z39JFpeN0Rvtes6PK7FH7qdGac8+1KUsSwCi0eFRHh1yvNFJhKh15t1h5Wa+lvFtyV/cSNRI+e3d3t6oMTu1naZmeqyN8M5XPIn+Oc8ui0mtS72sMxee6p6P2U6O0TO2VtDvASMbrTahe3CnThlzUQ/i3v/3tb+lHi1Ne1msp73J3dadcPrsmYiE3KXFJa7bXyxo9pd1yPTlXrn2/JfW6xlB8jns6aj+1ufY2riUJgNe0jlRH592euaiHOO1xR1h5Wa+FvFsTKZKWuSWROxe3lOUl2219jZ69pPmZ5s/lui/NZ/aztE7skWq+/vFx7umo/UyZaoNrT2mbAsBX5/QmMCPuwGnPkrvFJe8Ix/srud0RtFDX1kSKpGVwTeROLN1eqe2O7Nr1jK+7fG7PmjWGplKt1z8+xj0dtZ8puTb4jARAGVpUqqPDb9utd4u33uF9eHh4sb2wf5aJ861WaXlZclc3Vwa3yG3vkraW39bE0QBrzj0XTXDt9+lnaMPeawyVSKGshTc+hXL8/PycnsKseDt7KrGfcH65etVSAqAMLSrV0eH3ZSp6Ik5b7vCmd5q3bGs0LdS1LWvo7HV+aZkeqcylXyJvPfdcNMG136efYQxpPTsivX379ssPP/ywaP26+O/2tHU/JdbSuaSjnblvgF5pUamODr8vc9ETpa51mAQqta1R/PLLL7/nV/hSX6sta+jEZWJNtMqUXJkuuf2a5c79lvNO/zZ+c1s6uZR+hrHkypp0XjqjHsb7B6AMLSrV0eH3Ye4L3UXu39Yqua0RhMH8Jb/CHe8epREEt0arXJNuP6RRJoLSc1963mk9XdJOwF5CpE9o/0LkT1r+ekshUjbcLGlJfPwAlKFFpTo6/D5MPcoRX9fcv61VclsjiK/PkscdWpSLICi5UHhu+yGVnmiqUe7cl5x3/PlgSTsBRwhrAIVJzLAm0Js3b16Vx5ZTOKfWJn+C+BwAKEOLSnXiDn/u7rDUZorDyON/36rktkYwUn6lC4UvjVZZKjcZMoLcec/lbWjP08+mf39JZzxuArc4qr4ftZ8ajXzuAHvRolKduMOf+4IgtZOmLPnMUiW3NYKR8itdKDykJdEqt9qyYHXL0sfBpvJ2LtonTtCCo8rsUfup0cjnDrAXLSrViTv83B1mqa00dyc//txWJbc1gtHyK/dK6tK2LFjdslw7nYsESj+TS6PlHe2Ky+2ejtpPjUY+d4C9aFGpjg5/HCWvdcltjWDU/Br1vI9wLRIo/l0uQUuOKrtH7adGI587wF60qFRHhz+Okte65LZGMGp+xeedi1JhvVwkUCz9XZxE/tCaqXJe2lH7qdHI5w6wFy0q1dHhj6PktS65rRGMml/XolTYLs7jy1vXwn/jfB+1/NGPo8rwUfup0cjnDrAXLepG4a0md3d37iIXpMMfQ/pGoK1KbmsEo+ZXLkpFJFBZ6VvXQh+Z5vklifyhVUe1oUftp0YjnzvAXrSoG13eauIucjk6/DGkbwTaquS2evfx48fh80sk0H5yb13LJWjZUWX5qP3UaORzB9iLFnWjuHNyF7kMHf4Y4utcIgpAuVkmfDl/+/bt73kVojNGlIsEopxQztL8LV3n4UxHtR1H7adGI587wF60qBu5i1yeDr9v4dGvMFla+jqX3l6v4rVYQnv166+/ph8ZSlxuTOKXFedtmqBlpR9hnnPUfmo08rkD7EWLupG7yOXJy76lj36Vus7xZGx4xIm8OP9D+zU6k/j7SfO2dJ2Hs6T92J6O2k+NRj53gL1oUQvRSZUjL/uUi/wJqdSjIPf3979v8/vvv09/zX9Qv17KTeKLBCojl7cl6zyc5cjyPHKbPfK5A+xFi1qITqocedmn3ORPSenCxqKA8vbK/9al0SoigYApR7ajR+6rNiOfO8BetKiFxJ2Uu8fb6PD7lEYD7HHXNET+XLYvCihP/cpLy6f8AaYc2U4cua/axOdubA1Qxni9yU7cPS5n5MEO26RRQLwmf+bFbTlAzpHt6JH7qo2xNUB54/UmO8ndPXanYp2RBztsp/zMkz/zLm35HhFqQB+ObEeP3FdtcmNrALbRkhYW361wp2IdHT1bKD/z5A/ANke2o0fuq1byAKAcLWlh6d0Kbif/2EL5mSd/ALY5sh09cl+1kgcA5WhJdxBHAX348CH9NVfo6NlC+ZknfwC2ObIdPXJftZIHAOVoSXfw8PDworOamgQKawTlXo29JaVvSfj555+v7iP9m7PFxwa3Un7myR+AbY5sR4/cV63kAUA5WtIdfP78+cu7d+9edFi//PLLi8+ESaH49yVTvPbQtcmf3N+cLT4uuJXyM0/+AGxzZDt65L5qJQ8AytGS7iRMAt3d3f3eYYWJmP/3//7f4gmZM1I4thC99Pz8nJ7OoeJjglspP/PkD8A2R7ajR+6rVvIAoBwt6Y7CRMqbN29edFxpCpFCYbKohHjtoSVpbjIq/O7x8THdxSHi44BbKT/z5A/AOrnH6vd25L5qJQ8AytGS7iysrRN3XHG6v78vNvkTpG8gK5Gm1i/aU7x/uJXyM0/+AKzzxz/+8dU4aW9H7qtW8gCgHC3pDnJ3iOL0r//6r+mf7Orp6enL27dvXx3HLenIhaLj/cKtlJ958gdgnXRs9Je//CX9SHHabHkAUJKWdAe5O0RxqmHB5anHxcK/5xaxPvK4433CrZSfaeni8wAsd0b7ecY+ayMPAMrRku4g7qimUoio+eGHH4o+AnaLucfFgnBc79+/f/W7IyKB0mOBWyg/eWFNrzhvwiOokLoWwVoiHdGPwB7icry3XF0clTwAKEdLWlhY+Hmqo8pF3Xz33Xdf/va3v7343BniY0ulx713JNBU/sESyk9eHJlYcvF5+nItgrVU2rsfgT3EZXhvubo4KnkAUI6WtJDcnZqw7k5sLurm7Luhl2PLPc+eO+497+DG+6nRv//7v/9+rffMB9apvfycJc4Xkz/Ecv3X3inX10Dt4jK8N3XmmyPzHaB3WtJCcndqwuLLU8KkQfyK+PD3tTsqEqjmjj5EeB2VD6xTc/k5k3xhSq7/Uk7gtSPrx5H7qp28AChHS7rR1J3T8IjFNenjYmE7YZ2OWuUigfaw9/bXCBN2uesc0sh35WpUY/mpgXzhYqrf0q5BXq7O7O3IfdVOXgCUoyXdKHfn9BZpNElI4U09NVt7rkvtvf1bpW9Oqu34eMn1yZMvXOT6LWUDpuXqzN6O3Fft5AVAOVrSjdIBwa13TXNRNSGFf6/V3h3x3ttf6tOnT18eHh5eXZtLuvVac4xayk9t5AsXaVsWt2m5SIc1yfpo9CQt30f0//H+RicvAMrRkq6UGyRvERZlDY+NXbZV87oypc55yt7bnzP3qFeaqJNrlCdfWNJvpb8vnUwM0aK4DB/ljH3WSl4AlKMlXWmPcOAwCRQ/Elbro2Alzzln7+1PmXvUK01H3P1jnbPKT+3kC0v6ramo1JKp5hsckErHBkc5Y5+1khcA5WhJV0oHtKUmBHKPHNWyOPSSu8cl7L39nHSAVyqF/Kr5cb4exfnPN/JlXLm2O6RS/VZq6ySSKCFqEcZecdm8v79PP7KbeL+j0z7A2C7jGPW/DL3KSnt1zOmjYHE6OyJoyd3jEvbefiqd/An5/+bNm1fnuiV9/Pgx3S07ifOdb+TLuI5qu6/JvfRgKokSogZx3QljgzBGO8rZ9bUmaduhfYCxxG2x+r+dXmWlPTvmMMB4//79i33E6azZz/Q49rp7vGfexm5Z70eaTrVEqF3Ex8Y38mU8R0f+XLM1Miiks/o/xhSXvSMnf4J436PLtR1A/6bGMWkyNriNFnSlozqhqYigM2Y/jzrnI/aTRv3MpbVC1E+6rZ7T2RFqF/Ex8Y18GU8tkT+3SO/059IZ/R9jOrPunLnvWskTGEtuHDOVjA2W04KudGQnNBcRdMSMZ272dU977yd9pn8ubb1THv4+3aa0b9RQvB++kS9jCe12Wu+2tmdHyN3pX5KO6AsZx9Hjnpwz910reQJjyLXBt6Twt9ZgnaYFXSkuZEfK3R3de8YzN/u6p733kzufXOK6qQi1pWmPqKF4+3wjX8aStnM9yPV/cdq7L2Qcaf05ow6due9ayRMYwy1t8NzYwBqsedO5yawlBXIPU3dHj4qoCGnvu8h75216Prm09zn2ZC5CrUS6tWzHf8s38mUMubtmvbRnU/1fmnqOBspd3yWp5zzZQ5p/Z9SheP98JU9gDLe0wdfGBrd+jxiBFnSlGjqh3IxnDxEVe+8vl28hHf2Gj1GtjRpaWrbjv+Eb+TKGW+6a9SLXpvcaDZS7vktTr3myhzjfzlLDMdRGnsAYttT1qTVYl36PGMHtucpvthTMUuZmPMNs5w8//FBkQuPoc91rf3N3Tu/v74vkFctsjRqau5sdf45v5MsY0royd9esF1N94Vw7Ubu5/mpLYl4u389SwzHURp7AGLbW9ak1WK0L9NW6XGVzwSxpLqLiu++++/K3v/0t/ZObHH2ue+0vd+dU1E/d5sr21N3svcpP6+TLGEa/zmk00FQ7Ubtcf5Wm1Jq/4aVcHp6lhmOojTyB/qVvat4i/R7R6pigtG25OrBSBbOUaxEVa+6CnnUnrPT+cucRkqifNsyV7Zxrvx+VfOlbrp0bUS4aqJVIoNw1LJlGiAbbqqY8i4+Dr3J5EurN3d1dE3UcmJe+qTl8V9sqfI+It9nKmGBPepWVcp1QTULBfvPmzasCf8siWGfdCdu6vyWDaNoV3+HPcZ1fS5+Hpj9ntde1SiOBQqpl0Lekj9qaWG7qepytpmOpRS5PLm2fO/vQvngsU/IpjZrHBGfQq6yU64Rq8/z8nC3wSxfBSv/uqDthW/M290XojPNgH5c7/FPXcWv56U3oPN++fft7noQ7pfRHO/dSLhIopBq+JF7ro7am0a/9raaux9lqOpZa5PIk929Am+L6XGryJ6h5THAGreVKrXQ4UwU+pKmIoNzdsCPdst/csU4lg+Ix3FJ+RhA/Sx06ul9//TX9CA3LtYF8k+sDj5a7RqXSyHcwt5q7LjWMF+Lj4atcnuT+DWjT3vU5NyaY+j7cs31ydwB7F9DS0kWw4pRGBOXuhh3plv1ODd7SFL74Pjw8/BYVRd9uKT8jiOuztx/05+z2uhVn5k/uGt16LLlo3ksa9Q7mVrnrUpNaj+tMuTzJ/RvQpqPqc65PTb8P92zf3O3YUQW0pLnFdEMKkyn/63/9r1f/fvSdsFvyNjeTuzaF8zdJ1L74miI/epe2Y0e31604sx6k12jNtbrW14kEWi7kU+7m0S3X4wjxsfFVnCe5CC6gbUfV56k+dZS+dN/c7Vg8c9jijOFcRNBRlW9Kyf0/PT29WP9kSRIt1LaS5acH8qNvru8yZ+bTXvtO72CKBLoufb3wHtellNqP7wxxntQewQXcJm2fj5D7PjxCX3pM7nYoTBDEhaXFRyuuRQT91//6X9M/OcQelX/NRNCSJGqoPvH1QX70zvVd5sx82mvfU3cw4zTK3cycXIRILtUW+XMRHyNfpdcuTUCb9nj9+1K578O96/8Md5LOGLY+W/jP//zPrzrSs87prAq4ZZJI1FA9zio/tZIffXN9lzkzn/bedxoJlKaz+vKz5SJELqnk64X3sne5aVF6HdMEtGmv17/fYqS2pP8z3FEonHFhafFO27U7ZGec09kVcMtE0CWdkW98FV8H5EfvXN9lzsynvfe9NBKo57ecXBvLxCncWT7jy8Wt4mPmq/RapgloU1yPz2qf42Po/Xuc1nKj9M5ba3facnfIzj6neN+1m5ssOjrf+Kql8nME+dE313eZM/PprH2nfXlILa5ZuERuLHNWvpfS+vHvIb2uaQLaVEM9TvvMnr/HnZfLncjdeWtJeuzhWfjcOR05E9piXuYmgmpdV6B3LZafPcmPvrm+y5yZT2ftO9eXx+nIfr2UqTd4zaVW++L4HFoWorPu7u6KlLX02qYJaFMN9TjXZ/aq3zM7WFpgah9Y5cKlU+lM6FHnNXdMcI3y85L86JvrO29JX7e3eN9H9KGpdM3C3lMvejmnODpra/lPr3Wa6F+uTV+StpY99lVTPa7pWPbS75kdLDdZUnPoWC5cOpWbCT3ivOaOCa5Rfl6SH31zfect6ev2lo4P9u5Dc3JvOekxtRrtkxOfV8tKlv/0eqeJ/uXa9KVpS9ljX/F1OltNx7KXfs/sYFOTJbXNOE+FT88NmtJzm/tsCSNUPPaj/LwkP/rm+s6L8+eI/isn7UNDOntR5twxtZJaWcR5q/icW5Yra2vHxul20kS/1kb+pOnstpe8+BqdraZj2Uu/Z3aiknc7SgqLP6YNYY2Fu+Zjo37Kzzdpnac/ru+8mvInHRuE1OuizGxXU9ktIS3/a8bGaf1JE/3KRf4slZa9kLS9dVlzXfdS07Hspd8zO9HU3Y4zZpyvzZifcTf0mhEqHvtRfr4K7U2cF+GuOf1R3ufVlD+5sUFI4d8hVVPZLSFX/m8dG6d/H3+xDy/ioF/ptb/l+0uu7MVpbUQa5cTX42w1Hcte+j2zCtQw45ybMQ+LQdYcPj1CxWM/ys9Xcd2vvc6znvI+r8b8SRdlXhMJQf9qLLslbBkbx3/z/Pz8Ylvhbaz0qVQ0c9r2xkk7fK4S17eUmo5lL/2eWQXmZpxvvetxi7monxaenR+h4rEf5eerOB9qr/Osp7zn5frBmoQ6GR/bnmMC2lRr2d1qbmx8qQtT0Rjx5x4eHn7/f9E//SodzTy3IP5c2aOs0Eff3d39nt/xdThbTceyl37PrCJzM85L73rcIhf101IhbvGYqYfy85V8GIPrnJfrB2uzJRKC/tVcdkuYGxtPRWPEn4nruOiffu0dzZy2w1Nlj7Iu1/WS3/E1OFtNx7KXfs+sMnMzzkekW56VPVt83HAr5ecr+TAG1zmvhT5wKhLCXWiCEer23Ng4J/3M3GfpQ3ydS0/+BLl2WETm/tL6m/58ppqOZS/9nlnF5u56lE4tav34OZfy85V8GIPrnNdSvuTGBO5C01IZLiWOxshFw8V5MmL+jOio65xGAk2VQcpIr2v685lqOpa99HtmlZu761Eq1XjHc4n4HOBWo5ef2tc+oSzX+aVWy//cmEBE0JhaK8MlxOv6xOX/hx9+eFWvR8yfER11nXORQHEZ1AaXlV7X9Ocz1XQse+n3zGjWCBWP/YxeflpY+4Ryrt0xH03r5T93FzokEUHjabUMb5GLhluS6FOpt3/dYqoMaoPLSq9r+vOZajqWvfR7ZjRrhIrHfkYvP/H5h9RqJCDLpHfMw13MUYXon9bL/9Rd6NbOg+3i6z+SuWi4qUR/Sr/96xZTZbB1uQjZNB0V7ZTma/rzmWo6lr30e2Y0a4SKx35GLj+h0x75/EeUu1t51ACuFlODWmiZsjwdEZcm+rP327+WistZ631rrp9ck0rkQ7y93M9nqulY9tLvmdGsESoe+xm1/KSh0qOd/8jCwDj9ojRSuHrusS8RM7ROW/46wnEq0Z/4+p41+RP01LdORZiuSVvzId5W7ucz1XQse+n3zGjWCBWP/YxYftJQ6ZB8AR5LbmDXq6mIH2WfnoxQl5d4enp6VcfTRH9qub65vnVr9MvZcue0Jm2Rbif9+Uw1Hcte+j0zmjVCxWM/I5afWkKlOd8I5T8X8dP7OTMe5fqbNAojTfSntusbl8Gt0S+1mqpn8QsmSl2XdDvpz2eq6Vj20u+Z0awRKh77GaH8zEVAmPwZW1oeSjyrX5v0HC9J5A89icv26C4RC3/+85/V+0HUVv7TqJkepeeYpnTcuUW6nfTnM+TG1r3q98xo1ggVj/2MUH5EQDAldwevt7uVyjsjUM4ZWY3lv8Zj2kvuBRNp2iLdTvrzGXJj6171e2Y0a4SKx356Lj+5uxNxcieUqTt4PQiRTGn5h14p54ysxvIfH9Me0bXXxni1pS3S7aQ/nyE9v57H1OflMkyooRGgXT2Xn5HuTrBdHA0UP8Pfotxb7pR/eqacM7Iay38aYVs6urb2yZ8g/XmtdDvpz2eo4RiO0v8Z0pyRKiDl9VR+rt0N6vnuBNvlXqG8x13LvU1N/ij/9Cwu6zCSMPapsfznImxLym2/lnTpb+N/2yLdTvrz0Wotc3vp/wxpzkgVkPJ6Kj+5iJ9ezo39TT3DX/qu5Z7SyR9vuWMU2ntG9PHjx1eRNrWp+dj2lPbHW6TbSX8+Wjre7l3/Z0hzRqqAlNdT+YnPJU4iH1gqTJa8f//+VRmqPRIoF/1m8oeR9NSXwRKhfX/79m31450R6+bj4+OL876/v08/cpM0D9Ofj1Z7mSvtnFyGGWc3ArSttfKT+6KbS7BVelc1TmdPCF2rByZ/GI32n9HEESahv/r111/Tj1RhxLoZR8iU6I/TPEx/Pkpu7DGCMc6SpoxWCSmrtfKThp1OJdjq2voCZz4aNlcPwp3GrYNNaI32n9HE/UDor2o1Yt2Mz7lEf5zmYfrzUXJjjxGMcZY0ZbRKSH4GPk3h9yEE9Zqays+S81qSRghH5TjXJoKmUskooaV1Q9lnVHE9gBG0UuZbOc6SSp9zur3056PE+w1plDHHsbkMC5zVCHCeJV8EL+na66xrKj+5OwtzCc4w92hYmkpFCc3VDaCuvgyO0EqZb+U4Syp9zun20p+PctZ+zzbW2dKEUSvjyLZEJKRRQenvS0UszFkazTCXRrnrQH3W1r89knoAX8X1AkbQSplv5ThLyI1vS0i3l/68t73OqxVjnS1NGLUyMv3a6pCm/j2kOCoojWYoFbEwJ+1Ecglaltarkgl4TR1hNK2U+VaOs4RctG4J6fbSn/e213m1YqyzpQmjVka+mnptdWis134J3du1CApRDbTuWhlfm9QNyIvryShyd+Vzkb70IVzvu7u73yO1WynzrRxnCXv12WkdPzpP9zqvVhyTy3CDoxsB6pWb8LlE+8xFC6UJAFoyYh+Wuyt/SdfW/6M9l+t9idRupcy3cpwl7HWuufH9HvvJCW3Jkfur0ZhnTdVGr5R8UyrqwN1DAFoS92GjSPvuXDpqbT/2l5bx9OdatXKcJex1rnPj+z2F7wPxvu7v79OPDGHfXIYV4lnhv//97+mvGdAt0T5Tyd1DAFoR918jeH5+fnXOU33/EWv7sb/0eqc/16qV4yxh73NN6/Ze+7mIowxD2xLamBHtm8uwQnge+FI5RW5wMbU20K3JegIA1C7ut1r09PT0am2P0kl/3rb4WuZ+rlUrx1nC3uea1umQ9ojyy60vNurkT7DP1YQN4rDA77//Pv01LJJ2KGkSEQRAreL+qjUhmmdujY/SSX/epvga5n6uVSvHWUJcj/eQ1uVLKh3ll1tfbGRjnz1V+vjx44sGYOQZWtZLG/pcCpONAFCbVr+ofPr06bd1NdL+du+kP29PfP1yP9eqleMs4XJTfq+3ZKX1eK+8Tbe91/m0omzuQiFxmN4vv/yS/hquynUiaQcQ0h6hpgCwRa4Pq1XoQ9PHKy4pPAo255bzjKMRcusD6c+/yT3yUls+pdc+/blWrRxnC+I6nUYNliynrtlLcoEqxWu9PDw8pL+Gq+KOJESVpf8Wp9KhpgCwRStfWNJXKscpTNBcc8sjJmk0QpgESvt1/flXU5M/NeVTfDy5n2vVynG2IHzHS8tm6XKatlGYAKJS4Y7RpaJ+99136a/hqjgE/bKW1FmvnQSAW7TQP6VfrC7pljv36aTOrXL9+i3771UuX5akI/Mu3m/u51q1cpytiL/z5dKaMjkVATfqa99TSi5VCs+Qx3d1ws9wi3gtqbSTTjuE9PcAcKba+6d08ufsVyqLBMpL82VJOirv4n3mfq5VK8fZkmvl9NYymVv0+ew2qiZKLtV6+/bt75X2//yf//NqJnfNjDBjicvLH/7wh1edwSWtvfMIAHuI+6ja1Db5E+QiXowT8/myJB0h3V/6c61aOc6WLCmnt9Tn9G9D5M/ZbVRNlFyqFR7buVTcf/7nf35VmUO6dUaYsaTlJZcAoDa19lM1Tv7E0kgC48SvluTL0WUu3V/6c61aOc4WpeU0Tblym3p+fnaNrpArVCtEZVwq73//7//9VSPQegoz2WHxs9BQjWDqedwzk8gfAGoU91W1eHx8fHFctU3+BLlIglsiB3q1JF+OLnPp/tKfa9XKcbYoV063pPA0Ca8puVQrbgTCHafYtRnillI4lxEmgnLP456RAKB2tfVbYYwSj71qnPyJpePEJZEDI5jLl6PLXLq/9OdatXKcPUnL7dIUFpjmNSWXaoW7EpcKHF4LHys9QyyNkf7lX/7lRTkCgBrFfVcN4qjscFe95smfIDdOJJ8vl0igo/Mq3V/6c61aOc6e5MrttRQmqclTcqnWL7/80nUlDrPS8ULXI6UjpBFHANCKmvqvdN2flu6q15SPNUkjKtKfj5DuL/25Vq0cJ0xRcqnW3//+998b2O+++y79dTdGmwg6at2ddL/AdWGtrru7u+7XyxjlPGlXLf1Xbt2fltSSj7W5FlFxhHR/6c+1auU4YYqSS7VCePGlgX3z5k36a8iaWmwauO4SOdf7ehmjnCftOrv/yvWlta/7kxMff7ro8d5amGhOI3+OLHPp/tKfa9XKccIUJZeqxY/xwBLpo1/KDyw3Sp0Z5Txp19llNNeXtjb5E6QTHEdO+rYw0TwVCXSEdH/pzzVKH4eEFim5VC2++wRzcncrddJwm1HqzCjnSbvOLqNpH3rU49ul5SY4jorISffbUjpCur/059qkj0Pe39+nH4Em1FnD4D+ER79q7gyoR+5uZe2DCajNKHVmlPOkXWeX0bP3X1ocCXRURE4afdRSOkK6v/Tn2sTjzBYfh4SLOmsY/IfaOwPqkQ5e4lfWKj+wzCh1Jj7Po6IB4BZn1cVcNG0P0kigI6T7bCkdId1f+nNt4uMz+UPL6qxh8B9q7wyoR3yn7UL5geWen5+HqTNnRAPALc6qi7lo2l70eE4lHZ0/6f7Sn2tT+/HBUkowVdPYstTlTlu8ToHyA8s9PDz8Xl/evn2b/ror6Z15qM1Z5TPeb9qntu6sPG3F0fkT7y+NOsulo9/iFguRcUfnD+xFCaZqGlu2UH5gufjO/9PTU/rr7mgfqNlZ5fOs/R6h53Mr4ej8WbNG0lkRm2lkHLRMCaZqGlu2UH5gudHqy2jnS1vOKp9n7fcIPZ9bCUfnTxqJuSQdHZGWWxPr6GOA0o6p4bBS3ODCrZQfWG60+jLa+dKWs8rnWfs9Qs/nVsJZ+ZNGAp0V5ZOTRv4cnTewB6WYqmlw2UL5getydzhHMNr50pazyudZ+z1Cz+dWwln5k4sEOluuXwxJ9A89OL+GwYyaOgPao/zAdaPe4RztfGnLWeXzrP0eoedzK+Hs/Dl7/7FR+0XGoDRTNQ0vWyg/cF06yB3lDqf2gZqdVT7P2u8Rej63Es7On3j/Ifrm8fEx/cghPn369OJYQhqlX2QM59RwWOjszoi2KT9w3ZH1JA6rP/OVvsGR5w23Oqt8nrXfI/R8biXEa/GcIV0L6JKO6CumHvk6Ky9gT0o1VdMAs4XyA9cdWU/SsPozF/s88rzhVmeVz7P2e4Sez62Ey1o8Z0W75NYCuqS9+4q0b7qkd+/epR+F5mkBqZrOmi2UH7juyHqSDq7jdMRd3tiR5w23Oqt8nrXfI/R8bj35/Pnzl/fv37/qI45MR/dHcCQtIFWLG2O4VRxO/OHDh/TXwMHt7FSI/yXtfZc3duR5w63OKp9n7fcIPZ9br671GXsk6J1STtU0yGzx8PDwogyF8GLgpSPb2bkQ/1tSibuz8fagJmE9krPK51n7PULP59arUn3G0nTW429wJC0gVYsbZbhVCCMOz29fytCR0QXQijPa2TQ6b81d3q31OT0GqEW6HsmRztrv3p6fn7s9N4BbaAGpms6arcIkkHIE086oH2l0XvqFd0naeqc2PYYtEYIhYuPu7m5zVBIEJcv5reJ99ySu72/fvk1/DTCMvlp3utPrQIRjKUcw7Yz6sSQ6LzcpVNKSY1jqcqxbtgEXe5X5Jc7c957i9uTp6Sn9NcAw+mrd6U6vAxGOpRzBtBL149OnT789RhXW5om3d0tKpb/fIxKiVIRgvI0S6xMxthJlcq0z972HEJ2XtksAI9MKUjUdNiUoRzBtS/24TPy8efPmxXbWpFS8Rs+e5o5hqXQNI5FAbFGiTK515r73sHckIUBrtIJUTYdNCcoRTFtaP0pE+UylXHTP5e0vud+VFB/HWrk31cBaZ5ajM/e9h7Re7t2eANSuj9adbvU2EOEcyhFMS78grU2tPvoUn8NWJbfFuM4sR2fuew+9nQ/AVlpDqqbjpgTlCPJCRE9cP9akVid+LuJz2arkthjXmeXozH2XlrZvAJgAonI6bkpQjuC1x8fHF3VjSWp9sienZPuQ5tWWV8szrpJl8lZpGW61vqft2/39ffoRgCEd37PADc4cBNEP5QheszjqVyXPP10MOqSPHz+mH4NZJcvkrdIy3OqC5nH79u7du9/e+AeACSAqd+YgiH4oR/BaXC9CWrs4au41y3OptqiC+Ni2yi0GfTnnEJEAS5Qsk7fKleHa6uwS8fGb/AH45vieBW5w5iCIfhz1OmloSan2NRdJdC3VFFVQKh9iIeonPeeQwpokMKeWdWtajwSqIQ8BaqRVpGo6cEo46nXS0JIt7WuIBrgl6ieXtloaeXQteqHkMcVCe5MeS0jWBWJKTevW5CKBWpBrFwD4RqtI1XTgAPtY276mEQq3bOeWz16TfsmbS3PRCyWPKSc8fhLWIFlyLIytxnVr4kigFiLYchGJAHyjVaRqOnCAfSxpX3N30+fSHtE2tx5DLs1F/8Wf20v4Ip8eU0jX8ouxxGWjhsmf4OHh4VWZrXE9q6l2Yq7uA4xov9EOFBB34gCUs6R9zX2hupbmIlyW7DOVu6O/JC215m/WSNdUuaS5/GIsR5XFW6QRbJdUWzRQrp0A4DWtI1XTkQPsY0n7mlsHZEmaimxJP5P+Xal0y13/+O/2NJeXU/nFWI4qi7cKk0Dv379/VW5rKLsifwBuU1cPA4laB0MArSvdvqYRLrnIlvRL2q1pD3tvf8qS/GIsZ5XFpaaigc4suyJ/AG6jlaRqOnSAfZRuX9MIl/QO/L/927+9+qJ2S0q3V0q8jyOl+RXS8/Nz+jEGclZZvMVUNNBZkUDpcezVTgD0ot4eBhoZDAG0aO/2demr4s929rGkkUCXdNYXas5zdlm81VTZjcvwXgtGPz09vWpfALhOa0nVdOwA+9izfZ17VXycarhbv2c+LJG+ZSlOZz5aw/HOLou3ykWx5VLpBaNDpFxu8gmA67SWVE3HDrCPvdrXcMc//WIWp3/5l39J/+RUe+XDLUI0w9u3b1/lVUgigfqXW8i4JUsngvZMNUwmA7SgrR6G4cSdOwDl7NW+xl9k0wVja1Tj8aXRDSKB+tbjQsZTC0aXTmHyFIDl2u9h6FrcyQNQzl7t6//4H//j1Ze0PfZTSo3HNxdRsee6Kpwjvca9RLNMLRhdKoUJJgBuU89oBzLijh6AcvZqX3PRDHvsp5Sajy+NBIpT6XVVOE/NZRCAvuhpqJpBEcA+9mpf04mKqVTL2jZ75UMJc5FANeYlt2l97R8A2qOnoWoGRQD72Kt9nYtaSVMNa9vslQ97mFtXpYa85Da5aDkA2JOehqoZFAHsY6/2dWnUSkg1rHWyVz7sZcm6KiKC2pBetxrqAwB9a2O0w7BaG5gDtEL7+lXr+TAVcSUiqH6tlz0A2qPHoWoGRwDlffr0Sfv6H1rPh7mIK5FAdWu97AHQHj0OVTM4Aijr6enpy5s3b7Sv/yGOoOnBVETQJZkUqoc6CMDR9DhUzeAIoKx04dmwqPDILhE0vay/MhcRdEkeD6uDMQ4AR9PjUDWDI4Cy4nZVJEi/lkwEhSQi6Hhe/w7AWfQ4VM3gCKAs7eq4ph4PExF0rDQKT10E4Ch6HKpmcARQlnZ1XEujgkISGVReLvInpF4ePwSgfkZ/VC0eIAGwnXaVi6mIoEsSGVSWyB8AzqbnoWoGSQBlaVe5uCUiKCRRQduk+SnyB4CjGf1RtXigBMB22lWumYsMEhW0nroHwNn0QFTNYAmgLO0q19waGZRLooW+mlr3BwDOoAeiavFdSAC28yWUNeaigqaSaKH8uj8hAcAZ9EBU7XIX0nPyAGX4EsoaJaKCpK/JmAaAsxj9AcBA4i+isIc10UIjJAA4m94IAAbiCyl7Ey30Oon6AaAGRn8AMIDcYrQAAIzD6A8ABpBO/pgAAgAYi9EfAAwgfSzHIykAAGMxAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQORNAAAAAAJ0zAQQAAADQuf8PWo6sWlzKuc8AAAAASUVORK5CYII=" />
     * critical place is await for the second element, we need to track where it should be and efficiently replace in
     * the logistics after resolve
     *
     * @param orderId
     * @return
     */
    //TODO ADAPT
    public Order deleteOrder(ObjectId orderId) {
        Order existingOrder = findOrderById(orderId);
        Tuple2<Integer, OrderShipmentParticle> shipmentParticle = findShipmentParticle(UserUtils.getUserId(), existingOrder.getShipmentParticle());

        if (shipmentParticle != null && !existingOrder.getIsShoplift()) {
            shipmentParticle = existingOrder.removeShipmentParticle(UserUtils.getUserId());
            OrderShipmentParticle particle = shipmentParticle._2;

            AtomicReference<Delay> delayRef = new AtomicReference<>(
                    Delay.builder()
                            .orderId(orderId)
                            .particleIndex(shipmentParticle._1)
                            .build());

            kafkaTemplate.send(KafkaTopic.AUCTION_RECREATION_EXPLICIT,
                    AuctionCreationRequest.recreationBuilder()
                            .path(PathFragment.builder()
                                    .from(particle.getFrom())
                                    .to(particle.getTo())
                                    .build())
                            //TODO decide how to calculate time
                            .bidsAcceptingTill(particle.getDeliveryTimeEstimated())
                            .itemId(existingOrder.getItems().stream().findFirst().orElseThrow())
                            .userId(existingOrder.getReceivers().stream().findFirst().orElseThrow())
                            .maximumRequiredBidPrice(particle.getPrice())
                            .build()
            ).whenComplete((c, t) -> {
                if (t != null) {
                    log.error("Failed to send message: {}", t.getMessage());
                } else {
                    RecordMetadata metadata = c.getRecordMetadata();
                    log.debug("Message sent successfully to topic {} partition {} offset {}",
                            metadata.topic(), metadata.partition(), metadata.offset());
                    delayService.save(delayRef.get());
                }
            });
            Order save = mongoTemplate.save(existingOrder);
            updateOrderStatus(existingOrder.getId(), OrderShipmentStatus.AWAITING);

            return save;
        }
//        else if (existingOrder.getReceiverId().equals(UserUtils.getUserId())) {
//            //todo calculate price
//            kafkaTemplate.send(KafkaTopic.BILLING_CREATION, ItemBillingCreation.builder()
//                    .itemId(existingOrder.getItemId())
//                    .billingStrategy(BillingCreation.BillingStrategy.REFUND)
//                    .build());
//        }

        return existingOrder;
    }

    //todo append to the _next particle, calculating the price or replace existing after submitted consent by both sides
    public Order assignCourier(Long courierId, String orderId) {
        if (ObjectId.isValid(orderId)) {
            Order orderById = findOrderById(new ObjectId(orderId));
            return mongoTemplate.save(applyCourierAssignment(orderById, courierId));
        }
        return null;
    }

    public Order findOrderById(String orderId) {
        return findOrderById(new ObjectId(orderId));
    }

    public Order findOrderById(ObjectId orderId) {
        return mongoTemplate.findById(orderId, Order.class);
    }


    private Order applyStatusUpdate(Order order, OrderShipmentStatus newStatus) {
        order.setStatus(newStatus);
        return order;
    }

    private Order applyCourierAssignment(Order order, Long courierId) {
        order.setShipmentParticle(
                OrderShipmentParticle.builder()
                        .courierId(courierId)
                        .build()
        );
        return order;
    }

    private void sendFanoutNotification(String title, String body) {
        notificationProducer.sendFanout(FanoutMessageBody.builder()
                .title(title)
                .body(body)
                .build());
    }
}
